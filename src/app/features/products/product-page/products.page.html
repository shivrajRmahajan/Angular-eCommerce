<app-header></app-header>
<div class="products-page">
  <div class="container">
    <h1 class="page-title">Products</h1>
    
    <!-- Search and Filters Section -->
    <div class="filters-section" *ngIf="!isLoading()">
      <div class="search-filter">
        <label for="search-input">Search Products:</label>
        <input
          type="text"
          id="search-input"
          class="search-input"
          placeholder="Search by name, description, or category..."
          [ngModel]="searchQuery()"
          (ngModelChange)="onSearchChange($event)"
        />
      </div>
      <div class="category-filter">
        <label for="category-select">Filter by Category:</label>
        <select 
          id="category-select" 
          class="category-select"
          [ngModel]="selectedCategory()"
          (ngModelChange)="onCategoryChange($event)">
          <option *ngFor="let category of categories()" [value]="category">
            {{ category === 'all' ? 'All Categories' : (category | titlecase) }}
          </option>
        </select>
      </div>
      <div class="results-count">
        Showing {{ paginationInfo().start }}-{{ paginationInfo().end }} of {{ paginationInfo().total }} products
      </div>
    </div>
    
    <div class="loading" *ngIf="isLoading()">
      <p>Loading products...</p>
    </div>

    <div class="products-grid" *ngIf="!isLoading() && paginatedProducts().length > 0">
      <div class="product-card" *ngFor="let product of paginatedProducts()">
        <div class="product-image-container" [routerLink]="['/products', product.id]">
          <img [src]="product.image" [alt]="product.title" class="product-image" />
          <div class="product-overlay">
            <button class="add-to-cart-btn" (click)="addToCart(product); $event.stopPropagation()">
              Add to Cart
            </button>
          </div>
        </div>
        
        <div class="product-info" [routerLink]="['/products', product.id]">
          <h3 class="product-title">{{ product.title }}</h3>
          <p class="product-category">{{ product.category }}</p>
          
          <div class="product-rating" *ngIf="product.rating">
            <div class="stars">
              <span *ngFor="let star of getStars(product.rating.rate)" [class.filled]="star" class="star">★</span>
            </div>
            <span class="rating-count">({{ product.rating.count }})</span>
          </div>
          
          <div class="product-price">
            <span class="price">{{ product.price.toFixed(2) | currency:'INR'}}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="no-products" *ngIf="!isLoading() && filteredProducts().length === 0">
      <p>No products found.</p>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="!isLoading() && filteredProducts().length > 0 && totalPages() > 1">
      <button 
        class="pagination-btn" 
        (click)="previousPage()"
        [disabled]="currentPage() === 1">
        <span>«</span>
        <span>Previous</span>
      </button>
      
      <div class="page-numbers">
        <button
          *ngFor="let page of getPageNumbers()"
          class="page-number"
          [class.active]="page === currentPage()"
          [class.ellipsis]="page === '...'"
          (click)="page !== '...' && typeof page === 'number' && goToPage(page)"
          [disabled]="page === '...'">
          {{ page }}
        </button>
      </div>
      
      <button 
        class="pagination-btn" 
        (click)="nextPage()"
        [disabled]="currentPage() === totalPages()">
        <span>Next</span>
        <span>»</span>
      </button>
    </div>
  </div>
</div>
