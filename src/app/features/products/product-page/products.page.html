<app-header></app-header>
<div class="products-page">
  <div class="container">
    <h1 class="page-title">Products</h1>
    
    <!-- Category Filter -->
    <div class="filters-section" *ngIf="!isLoading()">
      <div class="category-filter">
        <label for="category-select">Filter by Category:</label>
        <select 
          id="category-select" 
          class="category-select"
          [ngModel]="selectedCategory()"
          (ngModelChange)="onCategoryChange($event)">
          <option *ngFor="let category of categories()" [value]="category">
            {{ category === 'all' ? 'All Categories' : (category | titlecase) }}
          </option>
        </select>
      </div>
      <div class="results-count">
        Showing {{ filteredProducts().length }} products
      </div>
    </div>
    
    <div class="loading" *ngIf="isLoading()">
      <p>Loading products...</p>
    </div>

    <div class="products-grid" *ngIf="!isLoading() && filteredProducts().length > 0">
      <div class="product-card" *ngFor="let product of filteredProducts()">
        <div class="product-image-container" [routerLink]="['/products', product.id]">
          <img [src]="product.image" [alt]="product.title" class="product-image" />
          <div class="product-overlay">
            <button class="add-to-cart-btn" (click)="addToCart(product); $event.stopPropagation()">
              Add to Cart
            </button>
          </div>
        </div>
        
        <div class="product-info" [routerLink]="['/products', product.id]">
          <h3 class="product-title">{{ product.title }}</h3>
          <p class="product-category">{{ product.category }}</p>
          
          <div class="product-rating" *ngIf="product.rating">
            <div class="stars">
              <span *ngFor="let star of getStars(product.rating.rate)" [class.filled]="star" class="star">â˜…</span>
            </div>
            <span class="rating-count">({{ product.rating.count }})</span>
          </div>
          
          <div class="product-price">
            <span class="price">{{ product.price.toFixed(2) | currency:'INR'}}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="no-products" *ngIf="!isLoading() && filteredProducts().length === 0">
      <p>No products found.</p>
    </div>
  </div>
</div>
