<app-header></app-header>
<div class="product-details-page">
  <div class="container" *ngIf="!isLoading() && product()">
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
      <a routerLink="/products" class="breadcrumb-link">Products</a>
      <span class="breadcrumb-separator">></span>
      <a routerLink="/products" class="breadcrumb-link">Shop</a>
      <span class="breadcrumb-separator">|</span>
      <span class="breadcrumb-current">{{ product()?.title }}</span>
    </nav>
    
    <div class="product-details-content">
      <!-- Left Section: Product Images -->
      <div class="product-images-section">
        <div class="thumbnail-gallery">
          <div 
            *ngFor="let thumb of getThumbnailImages(); let i = index"
            class="thumbnail"
            [class.active]="i === 0"
            (click)="selectImage(thumb)">
            <img [src]="thumb" [alt]="product()?.title" />
          </div>
        </div>
        <div class="main-image">
          <img [src]="selectedImage()" [alt]="product()?.title" />
        </div>
      </div>

      <!-- Right Section: Product Details -->
      <div class="product-info-section">
        <h1 class="product-name">{{ product()?.title }}</h1>
        <div class="product-price">{{ product()?.price?.toFixed(2) | currency:'INR' }}</div>
        
        <div class="product-rating" *ngIf="product()?.rating">
          <div class="stars">
            <span *ngFor="let star of getStars(product()!.rating!.rate)" [class.filled]="star" class="star">â˜…</span>
          </div>
          <span class="rating-text">{{ product()?.rating?.count }} Customer Review</span>
        </div>

        <div class="product-description">
          <p>{{ product()?.description }}</p>
        </div>

        <!-- Size Selection -->
        <div class="product-options">
          <div class="option-group">
            <label class="option-label">Size</label>
            <div class="size-buttons">
              <button
                *ngFor="let size of sizes"
                class="size-btn"
                [class.active]="selectedSize() === size"
                (click)="selectSize(size)">
                {{ size }}
              </button>
            </div>
          </div>

          <!-- Color Selection -->
          <div class="option-group">
            <label class="option-label">Color</label>
            <div class="color-buttons">
              <button
                *ngFor="let color of colors"
                class="color-btn"
                [class.active]="selectedColor() === color.name"
                [style.background-color]="color.value"
                (click)="selectColor(color.name)"
                [attr.aria-label]="color.name + ' color'">
              </button>
            </div>
          </div>
        </div>

        <!-- Quantity and Action Buttons -->
        <div class="quantity-action-section">
          <div class="quantity-controls">
            <button class="quantity-btn" (click)="decreaseQuantity()">-</button>
            <input 
              type="number" 
              [value]="quantity()" 
              min="1"
              (change)="onQuantityChange($event)"
              class="quantity-input" />
            <button class="quantity-btn" (click)="increaseQuantity()">+</button>
          </div>
          <button class="add-to-cart-btn" (click)="addToCart()">
            Add To Cart
          </button>
          <button class="compare-btn">
            + Compare
          </button>
        </div>

        <!-- Product Metadata -->
        <div class="product-metadata">
          <div class="metadata-item">
            <span class="metadata-label">SKU :</span>
            <span class="metadata-value">SS001</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Category :</span>
            <span class="metadata-value">{{ product()?.category | titlecase }}</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Tags :</span>
            <span class="metadata-value">{{ product()?.category | titlecase }}</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Share :</span>
            <div class="social-icons">
              <a href="#" class="social-icon" aria-label="Facebook">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                </svg>
              </a>
              <a href="#" class="social-icon" aria-label="LinkedIn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6zM2 9h4v12H2z"></path>
                  <circle cx="4" cy="4" r="2"></circle>
                </svg>
              </a>
              <a href="#" class="social-icon" aria-label="Twitter">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="loading" *ngIf="isLoading()">
    <p>Loading product...</p>
  </div>

  <div class="error" *ngIf="!isLoading() && !product()">
    <p>Product not found.</p>
    <a routerLink="/products" class="back-link">Back to Products</a>
  </div>
</div>
